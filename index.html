<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>בדיקת פרטי רכב</title>
  <link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <style>
    :root { --primary-blue: #3B82F6; --light-blue: #EFF6FF; --dark-blue: #1E3A8A; --text-gray: #6B7280; --border-color: #D1D5DB; }
    body { font-family: 'Heebo', sans-serif; background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%); margin: 0; padding: 20px; color: #333; }
    .container { max-width: 880px; margin: 40px auto; background-color: #ffffff; border-radius: 24px; padding: 40px 30px; box-shadow: 0 20px 40px -5px rgba(27, 100, 240, 0.15); border: 1px solid rgba(255, 255, 255, 0.5); }
    .logo { max-width: 200px; margin: 0 auto 25px; display: block; }
    h1 { text-align: center; margin-bottom: 8px; color: var(--dark-blue); font-size: 32px; font-weight: 700; }
    .description { text-align: center; color: var(--text-gray); margin-bottom: 35px; font-size: 18px; }
    .input-group { display: flex; flex-direction: column; gap: 14px; align-items: stretch; }
    @media(min-width: 500px) { .input-group { flex-direction: row; justify-content: center; } }
    input[type="text"] { padding: 16px 20px; border-radius: 12px; border: 1px solid var(--border-color); font-size: 18px; width: 100%; text-align: center; transition: all 0.2s ease-in-out; box-shadow: 0 1px 2px rgba(0,0,0,0.05); }
    input[type="text"]:focus { outline: none; border-color: var(--primary-blue); box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.2); }
    button { padding: 16px 28px; background-color: var(--primary-blue); color: white; font-size: 17px; font-weight: bold; border: none; border-radius: 12px; cursor: pointer; transition: all 0.2s ease-in-out; box-shadow: 0 4px 12px -2px rgba(59, 130, 246, 0.4); }
    button:hover { background-color: #2563EB; transform: translateY(-2px); box-shadow: 0 6px 16px -2px rgba(59, 130, 246, 0.5); }
    button:disabled { background-color: #93C5FD; cursor: not-allowed; transform: translateY(0); box-shadow: none; }
    .actions-container { display: flex; justify-content: center; gap: 15px; margin-top: 25px; }
    .action-btn { background-color: var(--light-blue); color: var(--primary-blue); padding: 10px 20px; box-shadow: none; }
    .action-btn:hover { background-color: #DBEAFE; transform: translateY(-1px); box-shadow: none; }
    .hidden { display: none; }
    .results { margin-top: 20px; text-align: right; }
    .status-message { text-align: center; padding: 20px; border-radius: 12px; background-color: #FFFBEB; color: #B45309; font-size: 18px; font-weight: bold; margin: 20px 0; border: 1px solid #FDE68A; }
    .status-message.error { background-color: #FEF2F2; color: #DC2626; border-color: #FECACA; }
    .section-title { margin: 35px 0 15px; font-weight: bold; font-size: 22px; border-bottom: 3px solid var(--primary-blue); display: inline-block; padding-bottom: 6px; color: var(--dark-blue); }
    ul { list-style: none; padding: 0; margin: 0; }
    li { display: flex; justify-content: space-between; padding: 14px 10px; border-bottom: 1px solid #f0f2f5; font-size: 16px; border-radius: 8px; transition: background-color 0.2s ease; }
    li:last-child { border-bottom: none; }
    li:hover { background-color: var(--light-blue); }
    li strong { margin-left: 15px; color: #333; }
    li span { color: var(--text-gray); }
    .loader { border: 5px solid #E5E7EB; border-top: 5px solid var(--primary-blue); border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 40px auto; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    @media print { body { padding: 0; margin: 0; } #main-content, #action-buttons, .loader { display: none !important; } .container { box-shadow: none !important; border: none !important; margin: 0 !important; padding: 0 !important; max-width: 100% !important; width: 100% !important; } .results-wrapper { display: block !important; } li { background-color: transparent !important; } }
  </style>
</head>
<body>
  <div class="container">
    <div id="main-content">
      <svg class="logo" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="color: var(--primary-blue);"><path d="M18.91 14.1C18.91 14.1 18.81 14.7 18.21 14.7C17.61 14.7 15.61 14.7 15.61 14.7M5.01002 14.1C5.01002 14.1 5.11002 14.7 5.71002 14.7C6.31002 14.7 8.31002 14.7 8.31002 14.7M15.61 14.7L8.31002 14.7M15.61 14.7C15.61 14.7 16.01 12.7 15.01 12.2C14.01 11.7 12.31 12.5 12.01 12.5C11.71 12.5 9.91002 11.7 8.91002 12.2C7.91002 12.7 8.31002 14.7 8.31002 14.7M17.91 9H6.01002C5.01002 9 5.01002 8.9 5.01002 8L5.31002 6.5C5.31002 6.5 5.71002 5 6.91002 5H17.01C18.21 5 18.61 6.5 18.61 6.5L18.91 8C18.91 8.9 18.91 9 17.91 9Z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></svg>
      <h1>בדיקת פרטי רכב לפי מספר רישוי</h1>
      <p class="description">הקלד מספר רכב ולחץ על חיפוש</p>
      <div class="input-group">
        <input type="text" id="plate" placeholder="לדוגמה: 12-345-67" />
        <button id="searchButton" onclick="searchVehicle()"><i class="fas fa-search"></i> חיפוש</button>
      </div>
    </div>
    <div class="actions-container hidden" id="action-buttons">
      <button class="action-btn" id="printBtn"><i class="fas fa-print"></i> הדפסה</button>
      <button class="action-btn" id="downloadBtn"><i class="fas fa-download"></i> הורדה</button>
      <button class="action-btn" id="shareBtn"><i class="fas fa-share-alt"></i> שיתוף</button>
    </div>
    <div class="results-wrapper">
      <div class="results" id="resultsArea"></div>
    </div>
  </div>

  <script>
    const plateInput = document.getElementById("plate");
    const searchButton = document.getElementById("searchButton");
    const resultsArea = document.getElementById("resultsArea");
    const actionButtons = document.getElementById("action-buttons");

    const VEHICLE_BY_PLATE_RESOURCE_ID = '053cea08-09bc-40ec-8f7a-156f0677aff3';
    const MODEL_DETAILS_RESOURCE_ID = '142afde2-6228-49f9-8a29-9b6c3a0cbe40';
    const DISABLED_PERMIT_RESOURCE_ID = 'c8b9f9c8-4612-4068-934f-d4acd2e3c06e';
    const OFF_ROAD_VEHICLE_RESOURCE_ID = '851ecab1-0622-4dbe-a6c7-f950cf82abf9';
    const FROZEN_VEHICLE_RESOURCE_ID = 'f6efe89a-fb3d-43a4-bb61-9bf12a9b9099';
    const INACTIVE_FROZEN_VEHICLE_RESOURCE_ID = '6f6acd03-f351-4a8f-8ecf-df792f4f573a';
    const PERSONAL_IMPORT_RESOURCE_ID = '03adc637-b6fe-402b-9937-7c3d3afc9140';
    const HAND_DATA_RESOURCE_ID = 'bb2355dc-9ec7-4f06-9c3f-3344672171da';
    
    const API_BASE_URL = 'https://data.gov.il/api/3/action/datastore_search';

    let currentVehicleData = null;
    let currentPlate = '';

    const formatDate = (dateString) => {
        if (!dateString) return 'לא צוין';
        let dateToParse = String(dateString);
        if (/^\d{4}-\d{1,2}$/.test(dateToParse)) {
            const [year, month] = dateToParse.split('-');
            dateToParse = `${year}-${month.padStart(2, '0')}-01`;
        } else if (/^\d{4}$/.test(dateToParse)) {
            dateToParse = `${dateToParse}-01-01`;
        } else if (/^\d{8}$/.test(dateToParse)) { 
            dateToParse = `${dateToParse.substring(0,4)}-${dateToParse.substring(4,6)}-${dateToParse.substring(6,8)}`;
        } else if (/^\d{6}$/.test(dateToParse)) { 
            dateToParse = `${dateToParse.substring(0,4)}-${dateToParse.substring(4,6)}-01`;
        }
        const date = new Date(dateToParse);
        return isNaN(date.getTime()) ? 'לא צוין' : date.toLocaleDateString('he-IL', { year: 'numeric', month: '2-digit', day: '2-digit' });
    };

    const formatBoolean = (val) => (val === true || val === '1' || val === 1 ? 'כן' : 'לא');

    plateInput.addEventListener("keydown", (e) => {
      if (e.key === "Enter") { e.preventDefault(); searchVehicle(); }
    });

    function fetchJsonpAsPromise(resourceId, queryParams, useQ = false) {
        return new Promise((resolve, reject) => {
            const callbackName = 'jsonp_' + Date.now() + '_' + Math.floor(Math.random() * 100000);
            const params = new URLSearchParams({ resource_id: resourceId, callback: callbackName });
            if (useQ) {
              if (typeof queryParams === 'string') params.append('q', queryParams);
              else params.append('q', JSON.stringify(queryParams));
            } else {
              params.append('filters', JSON.stringify(queryParams));
            }
            const url = `${API_BASE_URL}?${params.toString()}`;
            window[callbackName] = (data) => {
                document.body.removeChild(script);
                delete window[callbackName];
                if (data.success) resolve(data.result);
                else reject(new Error('ה-API החזיר שגיאה.'));
            };
            const script = document.createElement('script');
            script.src = url;
            script.onerror = () => {
                document.body.removeChild(script);
                delete window[callbackName];
                reject(new Error('שגיאת רשת או תקשורת מול השרת.'));
            };
            document.body.appendChild(script);
        });
    }
    
    async function enrichAndDisplay(vehicleData) {
        const specificRamatGimur = vehicleData.ramat_gimur;

        const modelDetailsPromise = (async () => {
            const { tozeret_nm, kinuy_mishari, degem_nm, shnat_yitzur } = vehicleData;
            if (tozeret_nm && shnat_yitzur && (degem_nm || kinuy_mishari)) {
                const normalizedTozeretNm = tozeret_nm.split('-')[0];
                let modelDataResult;
                if (degem_nm) modelDataResult = await fetchJsonpAsPromise(MODEL_DETAILS_RESOURCE_ID, { tozeret_nm: normalizedTozeretNm, degem_nm: degem_nm, shnat_yitzur: String(shnat_yitzur) }, true);
                if (!modelDataResult || modelDataResult.records.length === 0) modelDataResult = await fetchJsonpAsPromise(MODEL_DETAILS_RESOURCE_ID, { tozeret_nm: normalizedTozeretNm, kinuy_mishari: kinuy_mishari, shnat_yitzur: String(shnat_yitzur) }, true);
                if (!modelDataResult || modelDataResult.records.length === 0) modelDataResult = await fetchJsonpAsPromise(MODEL_DETAILS_RESOURCE_ID, { tozeret_nm: normalizedTozeretNm, kinuy_mishari: kinuy_mishari }, true);
                if (modelDataResult && modelDataResult.records.length > 0) return modelDataResult.records[0];
            }
            throw new Error("לא נמצאו פרטי דגם טכניים תואמים.");
        })();
        
        const permitPromise = fetchJsonpAsPromise(DISABLED_PERMIT_RESOURCE_ID, vehicleData.mispar_rechev.toString(), true);
        const handDataPromise = fetchJsonpAsPromise(HAND_DATA_RESOURCE_ID, { mispar_rechev: parseInt(vehicleData.mispar_rechev) }, false);
        
        const [modelResult, permitResult, handResult] = await Promise.allSettled([modelDetailsPromise, permitPromise, handDataPromise]);
        
        let finalData = { ...vehicleData };
        if (modelResult.status === 'fulfilled' && modelResult.value) {
            finalData = { ...finalData, ...modelResult.value };
            if (specificRamatGimur) finalData.ramat_gimur = specificRamatGimur;
        }
        if (handResult.status === 'fulfilled' && handResult.value.records.length > 0) {
            const sortedHandRecords = handResult.value.records.sort((a, b) => b.baalut_dt - a.baalut_dt);
            finalData.mispar_yad_nochichit = sortedHandRecords.length;
            finalData.baalut_dt = sortedHandRecords[0].baalut_dt;
            if (sortedHandRecords.length > 1) {
                finalData.baalut_rishonit = sortedHandRecords[sortedHandRecords.length - 1].baalut;
            }
        }
        
        finalData.has_disabled_permit = (permitResult.status === 'fulfilled' && permitResult.value.records.length > 0);
        
        displayResults(finalData);
    }

    async function searchVehicle() {
      const originalPlate = plateInput.value.trim();
      currentPlate = originalPlate.replace(/-/g, '');
      if (!/^\d{5,8}$/.test(currentPlate)) {
        resultsArea.innerHTML = `<p style="color:red; text-align:center;">אנא הזן מספר רישוי תקני (5-8 ספרות).</p>`;
        actionButtons.classList.add('hidden');
        return;
      }
      
      searchButton.disabled = true;
      searchButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> מחפש...';
      resultsArea.innerHTML = '<div class="loader"></div>';
      actionButtons.classList.add('hidden');
      const newUrl = `${window.location.pathname}?search=${currentPlate}`;
      window.history.pushState({plate: currentPlate}, '', newUrl);

      try {
        const activePromise = fetchJsonpAsPromise(VEHICLE_BY_PLATE_RESOURCE_ID, { mispar_rechev: currentPlate }, false);
        const importPromise = fetchJsonpAsPromise(PERSONAL_IMPORT_RESOURCE_ID, { mispar_rechev: currentPlate }, false);
        const offRoadPromise = fetchJsonpAsPromise(OFF_ROAD_VEHICLE_RESOURCE_ID, { mispar_rechev: currentPlate }, false);
        const frozenPromise = fetchJsonpAsPromise(FROZEN_VEHICLE_RESOURCE_ID, { mispar_rechev: currentPlate }, false);
        const inactiveFrozenPromise = fetchJsonpAsPromise(INACTIVE_FROZEN_VEHICLE_RESOURCE_ID, { mispar_rechev: currentPlate }, false);

        const [activeResult, importResult, offRoadResult, frozenResult, inactiveFrozenResult] = await Promise.allSettled([activePromise, importPromise, offRoadPromise, frozenPromise, inactiveFrozenPromise]);
        
        if (activeResult.status === 'fulfilled' && activeResult.value.records.length > 0) {
            await enrichAndDisplay(activeResult.value.records[0]);
        } else if (importResult.status === 'fulfilled' && importResult.value.records.length > 0) {
            let vehicleData = importResult.value.records[0];
            vehicleData.is_personal_import = true;
            await enrichAndDisplay(vehicleData);
        } else if (offRoadResult.status === 'fulfilled' && offRoadResult.value.records.length > 0) {
            const record = offRoadResult.value.records[0];
            const statusHtml = `<div class="status-message error"><strong>סטטוס הרכב: הורד מהכביש</strong><ul style="text-align: right; font-size: 16px; margin-top: 15px; list-style-position: inside;"><li><strong>תאריך ביטול:</strong> ${formatDate(record.bitul_dt)}</li></ul></div>`;
            displayResults(record, statusHtml);
        } else if (frozenResult.status === 'fulfilled' && frozenResult.value.records.length > 0) {
            const record = frozenResult.value.records[0];
            const statusHtml = `<div class="status-message"><strong>סטטוס הרכב: רישיון לא פעיל (מוקפא)</strong><ul style="text-align: right; font-size: 16px; margin-top: 15px; list-style-position: inside;"><li><strong>סיבה:</strong> ${record.sug_peula_nm || 'לא צוין'}</li><li><strong>תאריך ביצוע:</strong> ${formatDate(record.taarich_bitzul)}</li></ul></div>`;
            displayResults(record, statusHtml);
        } else if (inactiveFrozenResult.status === 'fulfilled' && inactiveFrozenResult.value.records.length > 0) {
            const record = inactiveFrozenResult.value.records[0];
            const statusHtml = `<div class="status-message"><strong>סטטוס הרכב: רישיון לא פעיל (הקפאה)</strong><ul style="text-align: right; font-size: 16px; margin-top: 15px; list-style-position: inside;"><li><strong>תאריך ביצוע:</strong> ${formatDate(record.taarich_bitzul)}</li></ul></div>`;
            displayResults(record, statusHtml);
        } else {
            resultsArea.innerHTML = `<p style="text-align:center;">לא נמצאו נתונים לרכב עם מספר רישוי <strong>${currentPlate}</strong> באף אחד מהמאגרים.</p>`;
        }
      } catch (error) {
        resultsArea.innerHTML = `<p style="color:red; text-align:center;">${error.message}</p>`;
      } finally {
        searchButton.disabled = false;
        searchButton.innerHTML = '<i class="fas fa-search"></i> חיפוש';
      }
    }

    function displayResults(vehicle, statusMessage = '') {
      currentVehicleData = vehicle;
      const hanaaTypes = new Set();
      if (vehicle.technologiat_hanaa_nm) hanaaTypes.add(vehicle.technologiat_hanaa_nm);
      if (vehicle.hanaa_nm) hanaaTypes.add(vehicle.hanaa_nm);
      const combinedHanaa = Array.from(hanaaTypes).join(' / ');

      displayResults.groups = {
        'פרטי רכב': { 'מספר רכב': vehicle.mispar_rechev, 'יצרן': vehicle.tozar || vehicle.tozeret_nm?.split('-')[0], 'ארץ יצור': vehicle.tozeret_eretz_nm, 'כינוי מסחרי': vehicle.kinuy_mishari, 'דגם יצרן': vehicle.degem_nm, 'רמת גימור': vehicle.ramat_gimur, 'שנת ייצור': vehicle.shnat_yitzur, 'תיבת הילוכים': (vehicle.automatic_ind === '1' || vehicle.automatic_ind === 1) ? 'אוטומטית' : 'ידנית', 'צבע': vehicle.tzeva_rechev },
        'רישוי ובעלות': { 'תו חניה לנכה': formatBoolean(vehicle.has_disabled_permit), 'יבוא אישי': formatBoolean(vehicle.is_personal_import), 'בעלות ראשונה': vehicle.baalut_rishonit, 'סוג בעלות נוכחית': vehicle.baalut, 'מספר יד נוכחי': vehicle.mispar_yad_nochichit, 'תאריך בעלות נוכחית': formatDate(vehicle.baalut_dt), 'הוראת רישום': vehicle.horaat_rishum, 'קבוצת אגרה': vehicle.kvuzat_agra_cd, 'תוקף רישיון (טסט)': formatDate(vehicle.tokef_dt), 'תאריך טסט אחרון': formatDate(vehicle.mivchan_acharon_dt), 'מועד עלייה לכביש': formatDate(vehicle.moed_aliya_lakvish), },
        'נתונים טכניים': { 'מספר שלדה': vehicle.misgeret, 'סוג מרכב': vehicle.merkav, 'סוג דלק': vehicle.sug_delek_nm || vehicle.delek_nm, 'נפח מנוע (סמ"ק)': vehicle.nefah_manoa, 'דגם מנוע': vehicle.degem_manoa, 'מספר מנוע': vehicle.mispar_manoa, 'הספק מנוע (כ"ס)': vehicle.koah_sus, 'סוג הנעה': combinedHanaa, 'משקל כולל': vehicle.mishkal_kolel, 'מספר דלתות': vehicle.mispar_dlatot, 'מספר מקומות ישיבה': vehicle.mispar_moshavim, 'רמת זיהום אוויר': vehicle.kvutzat_zihum, 'מידות צמיגים': vehicle.zmig_ahori },
        'מערכות בטיחות': { 'כריות אוויר': vehicle.mispar_kariot_avir, 'מערכת ABS': formatBoolean(vehicle.abs_ind), 'בקרת יציבות': formatBoolean(vehicle.bakarat_yatzivut_ind), 'בקרת סטייה מנתיב': formatBoolean(vehicle.bakarat_stiya_menativ_ind), 'ניטור מרחק מלפנים': formatBoolean(vehicle.nitur_merhak_milfanim_ind), 'זיהוי בשטח "מת"': formatBoolean(vehicle.zihuy_beshetah_nistar_ind), 'זיהוי הולכי רגל': formatBoolean(vehicle.zihuy_holchey_regel_ind), 'מצלמת רוורס': formatBoolean(vehicle.matzlemat_reverse_ind), 'חיישני לחץ אוויר': formatBoolean(vehicle.hayshaney_lahatz_avir_batzmigim_ind) },
        'אבזור': { 'הגה כוח': formatBoolean(vehicle.hege_koah_ind), 'חלונות חשמל': vehicle.mispar_halonot_hashmal, 'חלון בגג': formatBoolean(vehicle.halon_bagg_ind), 'גלגלי סגסוגת קלה': formatBoolean(vehicle.galgaley_sagsoget_kala_ind), 'בקרת שיוט אדפטיבית': formatBoolean(vehicle.bakarat_shyut_adaptivit_ind) }
      };

      let groupsHtml = '';
      for (const [title, details] of Object.entries(displayResults.groups)) {
        let sectionHtml = '';
        for (const [label, val] of Object.entries(details)) {
          if (val !== null && val !== undefined && val !== '' && val !== 'לא קיים' && val !== 'לא צוין') {
            sectionHtml += `<li><strong>${label}</strong><span>${val}</span></li>`;
          }
        }
        if (sectionHtml) groupsHtml += `<div><h4 class="section-title">${title}</h4><ul>${sectionHtml}</ul></div>`;
      }
      resultsArea.innerHTML = statusMessage + groupsHtml;
      if (groupsHtml) actionButtons.classList.remove('hidden');
    }

    document.getElementById('printBtn').addEventListener('click', () => window.print());

    document.getElementById('downloadBtn').addEventListener('click', () => {
        html2canvas(document.querySelector(".results-wrapper")).then(canvas => {
            const link = document.createElement('a');
            link.download = `car-details-${currentPlate}.png`;
            link.href = canvas.toDataURL("image/png");
            link.click();
        });
    });

    document.getElementById('shareBtn').addEventListener('click', async () => {
        const inIframe = window.self !== window.top;
        const shareBtn = document.getElementById('shareBtn');
        const originalText = shareBtn.innerHTML;

        if (inIframe) {
            let shareText = `פרטי רכב עבור מספר רישוי: ${currentPlate}\n\n`;
            if (currentVehicleData) {
                for (const [title, details] of Object.entries(displayResults.groups)) {
                    let sectionHasContent = false;
                    let sectionText = `--- ${title} ---\n`;
                    for (const [label, val] of Object.entries(details)) {
                        if (val !== null && val !== undefined && val !== '' && val !== 'לא קיים') {
                           sectionText += `${label}: ${val}\n`;
                           sectionHasContent = true;
                        }
                    }
                    if (sectionHasContent) shareText += sectionText + '\n';
                }
            }
            try {
                await navigator.clipboard.writeText(shareText);
                shareBtn.innerHTML = '<i class="fas fa-check"></i> הפרטים הועתקו!';
            } catch (err) {
                alert('שגיאה בהעתקת הפרטים.');
            } finally {
                setTimeout(() => { shareBtn.innerHTML = originalText; }, 2000);
            }
        } else {
            const shareUrl = `${window.location.origin}${window.location.pathname}?search=${currentPlate}`;
            const shareTitle = `פרטי רכב: ${currentPlate}`;
            const shareText = `בדוק את פרטי הרכב עבור מספר רישוי ${currentPlate}`;

            if (navigator.share) {
                try { await navigator.share({ title: shareTitle, text: shareText, url: shareUrl }); } catch (err) {}
            } else {
                try {
                    await navigator.clipboard.writeText(shareUrl);
                    shareBtn.innerHTML = '<i class="fas fa-check"></i> הקישור הועתק!';
                    setTimeout(() => { shareBtn.innerHTML = originalText; }, 2000);
                } catch (err) {
                    window.prompt("לא ניתן היה להעתיק אוטומטית. אנא העתק את הקישור:", shareUrl);
                }
            }
        }
    });
    
    document.addEventListener('DOMContentLoaded', () => {
        const params = new URLSearchParams(window.location.search);
        const plateFromUrl = params.get('search');
        if (plateFromUrl) {
            plateInput.value = plateFromUrl;
            searchVehicle();
        }
    });
  </script>
</body>
</html>
